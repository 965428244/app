# Взаимодействие Livestyle RV (Chrome) с приложением LiveStyle (app)

* `rv-get-session` — запрос на получение данных о сессии для указанного локального сайта. Ответ на запрос придёт в сообщении `rv-session`. Передаваемые параметры:
    * `localSite` (String): локальный сайт, для которого хотим получить сессию
* `rv-session` — ответ на запросы `rv-get-session` и `rv-create-session`. Возвращаемые данные:
    * `localSite` (String): локальный сайт, для которого делался запрос
    * `active` (Boolean): указывает, есть ли активная RV-сессия
    * `sessionId` (String): идентификатор активной сессий
    * `publicId` (String): публичный идентификатор (домен) сессии.
    * `error` (String): сообщение о важной ошибке, о которой должен знать пользователь (например, при создании сессии).
* `rv-create-session` – запрос на создание RV-сессии. После создания Передаваемые данные:
    * `connectUrl` (String): URL для подключения туннеля.
    * `publicId` (String): публичный идентификатор сессии (домен)
    * `localSite` (String): локальный сайт, для которого нужно создать подключеине.
* `rv-close-session` — закрытие указанной сессии RV. Передаваемые данные:
    * `localSite` (String) – локальный сайт, для которого закрываем сессию.
* `rv-ping` — проверка наличия подключённого клиента, способного обеспечить работу с Remote View.
* `rv-pong` – ответ RV-приложения на запрос `rv-ping`. Означает, что к LS-серверу подключён клиент, который может работать с Remote View.

## Создание RV-сессии из расширения Chrome

1. Проверка наличия подключённого приложения LiveStyle (`rv-ping`/`rv-pong`).
2. Запрашиваем токен пользователя.
3. Делаем ajax-запрос с токеном и локальным сайтом на RV-сервер для получения сессии.
4. Передаём полученные данные сессии LS-приложению в сообщении `rv-create-session`.
5. Ожидаем от приложения сообщения `rv-session` и либо показываем статус подключения, либо сообщаем об ошибке.